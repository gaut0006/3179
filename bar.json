{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "description": "Scatter plot comparing deaths vs % of risky Alcohol drinkers (age 14+) per state (2019 & 2022, zoomed axes)",
  "width": 450,
  "height": 450,
  "data": {
    "url": "https://raw.githubusercontent.com/gaut0006/3179/refs/heads/main/Prevalence_by_state_year%20and%20deaths%20-%20prevalence_by_state_year%20and%20deaths%20(1).csv"
  },
  "transform": [
    { "filter": "datum.year == 2019 || datum.year == 2022" },
    { "pivot": "metric", "value": "value", "groupby": ["state", "year"] }
  ],
  "layer": [
    {
      "params": [
        {
          "name": "stateSel",
          "select": { "type": "point", "fields": ["state"], "on": "click" },
          "bind": "legend"
        }
      ],
      "mark": { "type": "circle", "size": 200, "opacity": 0.9, "stroke": "white", "strokeWidth": 1 },
      "encoding": {
        "x": {
          "field": "alcohol_induced_deaths_rate_per_100k",
          "type": "quantitative",
          "title": "Alcohol-induced Deaths per 100k",
          "scale": { "domain": [3, 13.5] },
          "axis": { "labelFontSize": 13, "titleFontSize": 15, "gridOpacity": 0.2 }
        },
        "y": {
          "field": "risky_2020_guideline_pct_14plus",
          "type": "quantitative",
          "title": "% of Risky Alcohol Drinkers",
          "scale": { "domain": [20, 40] },
          "axis": { "labelFontSize": 13, "titleFontSize": 15, "gridOpacity": 0.2 }
        },
        "color": {
          "field": "state",
          "type": "nominal",
          "legend": {
            "title": "State (click legend to highlight a particular state)",
            "titleFontSize": 13,
            "labelFontSize": 12,
            "titleLimit": 0
          }
        },
        "opacity": {
          "condition": { "param": "stateSel", "value": 1 },
          "value": 0.15
        },
        "tooltip": [
          { "field": "state", "type": "nominal", "title": "State" },
          { "field": "year", "type": "ordinal", "title": "Year" },
          {
            "field": "alcohol_induced_deaths_rate_per_100k",
            "type": "quantitative",
            "title": "Deaths per 100k",
            "format": ".1f"
          },
          {
            "field": "risky_2020_guideline_pct_14plus",
            "type": "quantitative",
            "title": "% Risky drinkers",
            "format": ".1f"
          }
        ]
      }
    },
    {
      "mark": {
        "type": "text",
        "fontSize": 12,
        "fontStyle": "italic",
        "align": "right",
        "baseline": "bottom"
      },
      "encoding": {
        "x": { "aggregate": "max", "field": "alcohol_induced_deaths_rate_per_100k" },
        "y": { "aggregate": "min", "field": "risky_2020_guideline_pct_14plus" },
        "text": { "value": "Tip: Hover over to see exact values" },
        "xOffset": -8,
        "yOffset": -8
      }
    }
  ],
  "config": {
    "background": "#fafafa",
    "view": { "stroke": "transparent" }
  }
}