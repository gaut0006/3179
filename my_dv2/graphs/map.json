{
  "$schema": "https://vega.github.io/schema/vega-lite/v6.json",
  "width": 800,
  "height": 700,
  "title": {
    "text": "Alcohol-Induced Deaths per 100k by Australian State (2019)",
    "fontSize": 20,
    "font": "Inter",
    "anchor": "middle",
    "color": "#333"
  },
  "projection": {
    "type": "mercator",
    "center": [133, -30],
    "scale": 850,
    "translate": [400, 340]
  },
  "data": {
    "url": "https://raw.githubusercontent.com/gaut0006/3179/refs/heads/main/states_no.json",
    "format": { "type": "topojson", "feature": "statessss" }
  },
  "transform": [
    { "calculate": "trim(datum.properties.STE_NAME21)", "as": "state_name" },
    {
      "lookup": "state_name",
      "from": {
        "data": {
          "url": "https://raw.githubusercontent.com/gaut0006/3179/refs/heads/main/Prevalence.csv",
          "format": { "type": "csv" }
        },
        "key": "state",
        "fields": ["year", "metric", "value"]
      }
    },
    { "filter": "datum.metric == 'alcohol_induced_deaths_rate_per_100k'" },
    { "calculate": "toNumber(datum.year)", "as": "year_num" },
    { "filter": "datum.year_num == 2019" },
    { "calculate": "toNumber(datum.value)", "as": "value_num" },
    { "filter": "isValid(datum.value_num) && isFinite(datum.value_num)" }
  ],
  "mark": {
    "type": "geoshape",
    "stroke": "white",
    "strokeWidth": 1.2
  },
  "encoding": {
    "color": {
      "field": "value_num",
      "type": "quantitative",
      "title": "Alcohol-Induced Deaths (per 100k)",
      "scale": { "scheme": "reds", "domain": [2.5, 10] },
      "legend": {
        "title": "Deaths per 100k",
        "orient": "right",
        "direction": "vertical",
        "offset": 10,
        "gradientLength": 250,
        "labelFontSize": 12,
        "titleFontSize": 13,
        "format": ".1f"
      }
    },
    "tooltip": [
      { "field": "state_name", "title": "State" },
      { "field": "value_num", "title": "Deaths per 100k", "format": ".1f" }
    ]
  },
  "config": {
    "autosize": { "type": "fit", "contains": "padding" },
    "padding": { "top": 40, "bottom": 20 },
    "background": "#f5f6fa",
    "view": { "stroke": "transparent" },
    "style": {
      "guide-label": { "font": "Inter" },
      "guide-title": { "font": "Inter" }
    }
  }
}