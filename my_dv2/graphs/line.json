{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "description": "Bar-Line combo chart: guideline exceedance (%) vs deaths per 100k, by state (2022)",
  "data": {"url": "https://raw.githubusercontent.com/gaut0006/3179/refs/heads/main/Prevalence.csv"},
  "transform": [
    {"filter": "datum.year == 2022"},
    {
      "pivot": "metric",
      "value": "value",
      "groupby": ["state", "year"]
    }
  ],
  "layer": [
    {
      "mark": {"type": "bar", "opacity": 0.8, "color": "#afa6f4"},
      "encoding": {
        "x": {
          "field": "state",
          "type": "nominal",
          "axis": {"title": "State", "labelAngle": -30, "labelFontSize": 12}
        },
        "y": {
          "field": "exceeded_2020_guideline_pct",
          "type": "quantitative",
          "axis": {
            "title": "Exceeded 2020 Guideline (%)",
            "titleColor": "#afa6f4"
          }
        },
        "tooltip": [
          {"field": "state", "type": "nominal"},
          {"field": "exceeded_2020_guideline_pct", "title": "Guideline Exceeded (%)"}
        ]
      }
    },
    {
      "mark": {"type": "line", "color": "#e95555", "strokeWidth": 2, "point": true},
      "encoding": {
        "x": {"field": "state", "type": "nominal"},
        "y": {
          "field": "alcohol_induced_deaths_rate_per_100k",
          "type": "quantitative",
          "axis": {
            "title": "Alcohol-induced Deaths per 100k",
            "titleColor": "#E45756"
          }
        },
        "tooltip": [
          {"field": "state", "type": "nominal"},
          {"field": "alcohol_induced_deaths_rate_per_100k", "title": "Deaths per 100k"}
        ]
      }
    }
  ],
  "resolve": {"scale": {"y": "independent"}},
  "width": 650,
  "height": 450,
  "config": {
    "background": "#fafafa",
    "axis": {"gridOpacity": 0.2, "labelFontSize": 12, "titleFontSize": 14},
    "view": {"stroke": "transparent"}
  }
}
